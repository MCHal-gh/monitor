name: Kontrola Planetum PythonAnywhere

on:
  schedule:
    # BÄ›Å¾Ã­ kaÅ¾dou hodinu, v 0 minut, 0 hodin
    - cron: '0 0 * * *' 
  workflow_dispatch:

jobs:
  run_scraper:
    # PouÅ¾Ã­vÃ¡me novÄ›jÅ¡Ã­ a stabilnÄ›jÅ¡Ã­ runner
    runs-on: ubuntu-22.04 
    
    steps:
      - name: Checkout kÃ³d ğŸ“¦
        uses: actions/checkout@v4

      - name: NastavenÃ­ Python 3.11 ğŸ
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
          
      - name: Instalace zÃ¡vislostÃ­ a Chromium (KlÃ­ÄovÃ½ krok) ğŸ› ï¸
        run: |
          echo "Instaluji Selenium, Requests, BeautifulSoup a systÃ©movÃ© zÃ¡vislosti pro Chromium..."
          
          # 1. Instalace kritickÃ½ch systÃ©movÃ½ch knihoven pro headless mÃ³d
          sudo apt-get update
          sudo apt-get install -y libxss1 libappindicator1 libindicator7 build-essential
          
          # 2. Instalace samotnÃ©ho prohlÃ­Å¾eÄe Chromium
          sudo apt-get install -y chromium-browser
          
          # 3. Instalace Python knihoven
          pip install selenium requests beautifulsoup4
          
      - name: Run Python script ğŸš€
        env:
          # PÅ™edÃ¡nÃ­ tajnÃ½ch promÄ›nnÃ½ch do skriptu jako promÄ›nnÃ© prostÅ™edÃ­
          GMAIL_PASSWORD: ${{ secrets.GMAIL_PASSWORD }}
          GMAIL_USER: ${{ secrets.GMAIL_USER }}
        run: |
          echo "SpouÅ¡tÃ­m Python skript (cesta: /usr/bin/chromium-browser)..."
          python planetum_kontrola_gmail_pythonanywhere.py 
          echo "Skript dokonÄen."
